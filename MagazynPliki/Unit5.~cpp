//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit5.h"
#include "Unit1.h"
#include "Unit2.h"
#include "Unit3.h"
#include "Unit4.h"
#include "Unit6.h"
#include "Unit7.h"
#include "Unit8.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm5 *Form5;

//---------------------------------------------------------------------------
__fastcall TForm5::TForm5(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall DeleteRow(TStringGrid *Grid, int ARow)
{
 if(ARow < Grid->FixedRows)
 {
  Application->MessageBox("Nie wybrano wiersza do usuniêcia", "Usuwanie wiersza", MB_OK | MB_ICONSTOP);
  return;
 }
 if(Grid->RowCount == Grid->FixedRows + 1)
 {
  int id = Application->MessageBox("Conajmniej jeden wiersz (nie licz¹c nag³ówka) musi pozostaæ w tabeli. "
           "Czy chcesz wyczyœciæ zawartoœæ komórek w tym wierszu?", "Usuwanie wiersza", MB_YESNO | MB_ICONQUESTION);
  if(id == ID_YES)
   for(int y = 0; y < Grid->ColCount; y++)
    Grid->Cells[y][ARow] = "";
  return;
 }
  for(int i = ARow; i <= Grid->RowCount - 1; i++)
  {
   for(int y = 0; y < Grid->ColCount; y++)
   {
    Grid->Cells[y][i] = Grid->Cells[y][i + 1];
    Grid->Cells[y][i + 1] = "";
   }
  }
  Grid->RowCount--;
 Grid->SetFocus();
}

//---------------------------------------------------------------------------


void __fastcall TForm5::Button1Click(TObject *Sender)
{

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount+1; //dopisanie kategorii do Form2->StringGrid1 col[3]
         int lp = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[0][lp] = Form4->Edit2->Text;

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie nazwy do Form2->StringGrid1 col[3]
         int lp1 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[1][lp1] = Form4->Edit3->Text;

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie symbolu do Form2->StringGrid1 col[3]
         int lp8 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[2][lp8] = Form4->Edit1->Text;


         if(Form3->StringGrid3->Enabled==true){
         if(Edit1->Text==""){   //dla zmieñ ilosc
           Application->MessageBox(("Nie wpisano ilosci!!! „" + Edit1->Text + "”").c_str(),
           "Wpisz ilosc", MB_OK | MB_ICONINFORMATION);
           Edit1->Text="";
           return;
         }
         int stil=StrToInt(Edit2->Text);
         int noil=StrToInt(Edit1->Text);

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie symbolu do Form2->StringGrid1 col[3]
         int lp2 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[2][lp2] = Form3->Edit1->Text;

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie ilosci do Form2->StringGrid1 col[3]
         int lp3 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[3][lp3] = IntToStr(stil+noil);

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie obrazka do Form2->StringGrid1 col[3]
         int lp4 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[4][lp4] = Form2->StringGrid1->Cells[4][Form2->StringGrid1->Row];

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie schematu do Form2->StringGrid1 col[3]
         int lp5 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[5][lp5] = Form2->StringGrid1->Cells[5][Form2->StringGrid1->Row];

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie specyfikacji do Form2->StringGrid1 col[3]
         int lp6 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[6][lp6] = Form2->StringGrid1->Cells[6][Form2->StringGrid1->Row];

         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie opisu do Form2->StringGrid1 col[3]
         int lp7 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[7][lp7] = Form2->StringGrid1->Cells[7][Form2->StringGrid1->Row];


         DeleteRow(Form2->StringGrid1, Form2->StringGrid1->Row);

         Form3->SaveGridToFile("ListaElementow.roz",(Form2->StringGrid1),false );

         Form4->Close();
         Form3->Close();
         Form5->Close();
         }
         else{
         if(Edit1->Text!=""){               //dla dodaj ilosc
         Form2->StringGrid1->RowCount = Form2->StringGrid1->RowCount; //dopisanie ilosci do Form2->StringGrid1 col[3]
         int lp3 = Form2->StringGrid1->RowCount-1;
         Form2->StringGrid1->Cells[3][lp3] = Edit1->Text;

         Form3->SaveGridToFile("ListaElementow.roz",(Form2->StringGrid1),false );

         Form4->Close();
         Form3->Close();
         Form5->Close();
         Form6->Show();
         }
         else {
          Application->MessageBox(("Nie wpisano ilosci!!! „" + Edit1->Text + "”").c_str(),
   "Wpisz ilosc", MB_OK | MB_ICONINFORMATION);
   Edit1->Text="";
   return;
         }
         }
       
         
}
//---------------------------------------------------------------------------






